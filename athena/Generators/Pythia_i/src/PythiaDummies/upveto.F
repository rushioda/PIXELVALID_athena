
C*********************************************************************
 
C...UPVETO
C...Dummy routine, to be replaced by user, to veto event generation 
C...on the parton level, after parton showers but before multiple 
C...interactions, beam remnants and hadronization is added.
C...If resonances like W, Z, top, Higgs and SUSY particles are handed 
C...undecayed from UPEVNT, or are generated by PYTHIA, they will also 
C...be undecayed at this stage; if decayed their decay products will 
C...have been allowed to shower. 

C...All partons at the end of the shower phase are stored in the 
C...HEPEVT commonblock. The interesting information is 
C...NHEP = the number of such partons, in entries 1 <= i <= NHEP,
C...IDHEP(I) = the particle ID code according to PDG conventions,
C...PHEP(J,I) = the (p_x, p_y, p_z, E, m) of the particle.
C...All ISTHEP entries are 1, while the rest is zeroed.

C...The user decision is to be conveyed by the IVETO value.
C...IVETO = 0 : retain current event and generate in full;
C...      = 1 : abort generation of current event and move to next.
 
      SUBROUTINE UPVETO(IVETO)

C...HEPEVT
C      INCLUDE 'hepevt.inc'

C...Next few lines allow you to see what info PYVETO extracted from 
C...the full event record for the first two events. 
C...Delete if you don't want it. 
      INTEGER NLIST/0/
      SAVE NLIST
      IF(NLIST.LE.2) THEN
        WRITE(*,*) ' Full event record at time of UPVETO call:'
        CALL PYLIST(1)
        WRITE(*,*) ' Part of event record made available to UPVETO:'
        CALL PYLIST(5)
        NLIST=NLIST+1
      ENDIF

C...Make decision here.
      IVETO = 0

      RETURN
      END
