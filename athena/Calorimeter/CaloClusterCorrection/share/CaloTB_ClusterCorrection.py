#theApp.Dlls += ["CaloClusterCorrection"]


energy_samples = [20*GeV, 50*GeV, 180*GeV]
energy_samples_vle = [3*GeV, 5*GeV, 9*GeV, 20*GeV, 50*GeV, 180*GeV]

CALOCORR_EMB2 = 1
CALOCORR_EMB1 = 0
CALOCORR_CLUSTER = 5
CALOCORR_COMBINED2 = 4

#list of corrections in the conventional order
from CaloClusterCorrection.CaloClusterCorrectionConf import CaloSwEtaoff_v2
from CaloClusterCorrection.CaloClusterCorrectionConf import CaloSwEtamod_v2
from CaloClusterCorrection.CaloClusterCorrectionConf import CaloSwPhimod_v2
from CaloClusterCorrection.CaloClusterCorrectionConf import CaloLongWeights_v2
from CaloClusterCorrection.CaloClusterCorrectionConf import CaloPhiParabola
SshapB1 = CaloSwEtaoff_v2("SshapB1")
SshapB2 = CaloSwEtaoff_v2("SshapB2")
etamod = CaloSwEtamod_v2("etamod")
phimod = CaloSwPhimod_v2("phimod")
phipar = CaloPhiParabola("phipar")
weights = CaloLongWeights_v2("weights")

LArTBClusterMaker.ClusterCorrectionTools += [
    SshapB1.getFullName(),
    SshapB2.getFullName(),
    etamod.getFullName(),
    phimod.getFullName(),
    phipar.getFullName(),
    weights.getFullName()
    ]

LArTBClusterMaker += SshapB1
LArTBClusterMaker += SshapB2
LArTBClusterMaker += etamod
LArTBClusterMaker += phimod
LArTBClusterMaker += phipar
LArTBClusterMaker += weights
#
#S shape in the middle layer
#

LArTBClusterMaker.SshapB2.region = CALOCORR_EMB2
LArTBClusterMaker.SshapB2.degree = 3
LArTBClusterMaker.SshapB2.interp_barriers = str([0.8])
LArTBClusterMaker.SshapB2.energies = str(energy_samples)
LArTBClusterMaker.SshapB2.energy_degree = 2
LArTBClusterMaker.SshapB2.correction = str([
    [
    [ 0.05,   3.503490e-03,   2.901405e+00,   4.839290e-03], 
    [ 0.15,   3.516724e-03,   2.942001e+00,   1.446216e-02],
    [ 0.25,   3.505096e-03,   2.950688e+00,   2.981067e-02],
    [ 0.35,   3.506057e-03,   2.941437e+00,   4.752036e-02],
    [ 0.45,   3.500991e-03,   2.910294e+00,   7.630051e-02],
    [ 0.55,   3.494548e-03,   2.902326e+00,   9.869355e-02],
    [ 0.65,   3.384337e-03,   2.702028e+00,   1.814474e-01],
    [ 0.75,   3.140770e-03,   2.681672e+00,   3.120249e-01],
    [ 0.85,   3.357952e-03,   2.652087e+00,   7.732444e-02],
    [ 0.95,   3.166124e-03,   2.564356e+00,   2.773639e-01],
    [ 1.05,   3.038830e-03,   2.460855e+00,   4.116680e-01],
    [ 1.15,   2.899687e-03,   2.295528e+00,   5.554735e-01],
    [ 1.25,   2.856345e-03,   2.354065e+00,   6.470071e-01],
    [ 1.35,   2.797595e-03,   2.372002e+00,   7.424595e-01],
    ],

    [
    [ 0.05,   3.753791e-03,   3.081169e+00,  -1.171145e-02],
    [ 0.15,   3.714608e-03,   3.188118e+00,   5.329903e-03],
    [ 0.25,   3.660488e-03,   3.182998e+00,   1.015302e-02],
    [ 0.35,   3.679275e-03,   3.116574e+00,   2.173844e-02],
    [ 0.45,   3.702213e-03,   3.138002e+00,   4.252416e-02],
    [ 0.55,   3.671748e-03,   3.113081e+00,   4.745840e-02],
    [ 0.65,   3.593195e-03,   2.980820e+00,   1.269369e-01],
    [ 0.75,   3.422650e-03,   2.940236e+00,   2.206242e-01],
    [ 0.85,   3.608860e-03,   2.728802e+00,   2.380729e-02],
    [ 0.95,   3.374749e-03,   2.689585e+00,   1.837125e-01],
    [ 1.05,   3.272442e-03,   2.584887e+00,   2.980224e-01],
    [ 1.15,   3.165694e-03,   2.464632e+00,   3.957386e-01],
    [ 1.25,   3.093964e-03,   2.495809e+00,   4.656538e-01],
    [ 1.35,   3.091378e-03,   2.296467e+00,   5.458594e-01],
    ],

    [
    [ 0.05,   3.822734e-03,   3.491085e+00,  -1.118603e-03],
    [ 0.15,   3.811360e-03,   3.431343e+00,  -6.491349e-03],
    [ 0.25,   3.811308e-03,   3.443613e+00,  -2.772423e-03],
    [ 0.35,   3.830464e-03,   3.304869e+00,   6.697161e-04],
    [ 0.45,   3.810670e-03,   3.373219e+00,   1.788659e-02],
    [ 0.55,   3.817434e-03,   3.400790e+00,   2.317076e-02],
    [ 0.65,   3.736614e-03,   3.291341e+00,   6.612761e-02],
    [ 0.75,   3.636046e-03,   3.048799e+00,   1.489286e-01],
    [ 0.85,   3.699603e-03,   3.020125e+00,  -2.233352e-02],
    [ 0.95,   3.544020e-03,   2.883604e+00,   1.103127e-01],
    [ 1.05,   3.467178e-03,   2.818841e+00,   1.978377e-01],
    [ 1.15,   3.377931e-03,   2.669854e+00,   2.739294e-01],
    [ 1.25,   3.359356e-03,   2.630288e+00,   3.233065e-01],
    [ 1.35,   3.310702e-03,   2.648940e+00,   4.008334e-01],
    ]
    ])

#
#S shape in the strip layer
#


LArTBClusterMaker.SshapB1.region = CALOCORR_EMB1
LArTBClusterMaker.SshapB1.degree = 3
LArTBClusterMaker.SshapB1.interp_barriers = str([])
LArTBClusterMaker.SshapB1.energies = str(energy_samples)
LArTBClusterMaker.SshapB1.energy_degree = 2
LArTBClusterMaker.SshapB1.correction = str([
    [
    [ 0.05,   5.454591e-04,   9.412656e-04,  -6.932359e-02],
    [ 0.15,   5.154604e-04,   1.021430e+00,  -1.038913e-01],
    [ 0.25,   5.201964e-04,   1.000751e+00,  -1.463504e-01],
    [ 0.35,   5.367553e-04,   9.424765e-01,  -1.771538e-01],
    [ 0.45,   5.149588e-04,   1.518958e+00,  -2.407728e-01],
    [ 0.55,   5.223967e-04,   1.284795e+00,  -2.695521e-01],
    [ 0.65,   5.488658e-04,   1.071486e+00,  -3.196700e-01],
    [ 0.75,   5.168200e-04,   1.094533e+00,  -2.543394e-01],
    [ 0.85,   5.431384e-04,   1.097851e+00,  -4.690285e-01],
    [ 0.95,   5.589233e-04,   9.742528e-01,  -4.332120e-01],
    [ 1.05,   6.014312e-04,   8.057341e-01,  -4.236833e-01],
    [ 1.15,   5.970610e-04,   1.366552e+00,  -4.220011e-01],
    [ 1.25,   6.223524e-04,   1.168266e+00,  -4.073313e-01],
    [ 1.35,   5.688281e-04,   1.832655e+00,  -4.255659e-01],
    ],

    [
    [ 0.05,   5.083151e-04,   1.640668e+00,  -5.804533e-02],
    [ 0.15,   5.250131e-04,   1.268519e+00,  -9.703922e-02],
    [ 0.25,   5.066508e-04,   1.345091e+00,  -1.571868e-01],
    [ 0.35,   5.144519e-04,   1.572102e+00,  -1.906901e-01],
    [ 0.45,   5.189295e-04,   1.397721e+00,  -2.227306e-01],
    [ 0.55,   5.266921e-04,   1.547540e+00,  -2.985803e-01],
    [ 0.65,   5.438521e-04,   1.421734e+00,  -3.139286e-01],
    [ 0.75,   5.373358e-04,   1.229688e+00,  -2.613686e-01],
    [ 0.85,   5.519268e-04,   1.298233e+00,  -4.484270e-01],
    [ 0.95,   5.692822e-04,   1.195497e+00,  -4.080466e-01],
    [ 1.05,   5.702371e-04,   1.462703e+00,  -4.030915e-01],
    [ 1.15,   5.856113e-04,   1.387561e+00,  -4.095322e-01],
    [ 1.25,   6.112790e-04,   1.115509e+00,  -4.288708e-01],
    [ 1.35,   6.161961e-04,   6.686042e-01,  -4.251241e-01],
    ],

    [
    [ 0.05,   5.125756e-04,   1.848390e+00,  -4.738372e-02],
    [ 0.15,   5.031207e-04,   1.898598e+00,  -1.133694e-01],
    [ 0.25,   5.146895e-04,   1.732243e+00,  -1.611869e-01],
    [ 0.35,   5.177613e-04,   1.676791e+00,  -1.958575e-01],
    [ 0.45,   5.258374e-04,   1.748278e+00,  -2.314694e-01],
    [ 0.55,   5.265504e-04,   1.880923e+00,  -2.894795e-01],
    [ 0.65,   5.424095e-04,   1.647257e+00,  -3.266239e-01],
    [ 0.75,   5.165737e-04,   1.158308e+00,  -2.407142e-01],
    [ 0.85,   5.578103e-04,   1.642801e+00,  -4.616890e-01],
    [ 0.95,   5.714202e-04,   1.366883e+00,  -4.388472e-01],
    [ 1.05,   5.797266e-04,   1.551921e+00,  -4.201731e-01],
    [ 1.15,   5.989632e-04,   1.310139e+00,  -4.215782e-01],
    [ 1.25,   6.058142e-04,   1.300679e+00,  -4.277517e-01],
    [ 1.35,   6.064828e-04,   1.261988e+00,  -4.324420e-01],
    ]
    ])


#
#Longitudinal Weights; for the 3x3 cluster 
#derived with single electrons


CaloTB_lwc_33 = [
    [#eta              #w0            #w3             #offset          #w01           #scale
    [0.0125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.0375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.0625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.0875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.1125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.1375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.1625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.1875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.2125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.2375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.2625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.2875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.3125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.3375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.3625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.3875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.4125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.4375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.4625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.4875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.5125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.5375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.5625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.5875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.6125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.6375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.6625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.6875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.7125,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.7375,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.7625,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.7875,        0.2846,        0,        203.82,        0.308,        1.072],
    [0.8125,        0.2846,        0,        203.82,        0.308,        1.072],
    ],
    [
    [0.0125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.0375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.0625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.0875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.1125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.1375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.1625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.1875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.2125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.2375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.2625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.2875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.3125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.3375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.3625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.3875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.4125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.4375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.4625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.4875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.5125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.5375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.5625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.5875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.6125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.6375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.6625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.6875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.7125,        0.387,        0,        172.4,        0.279,        1.058],
    [0.7375,        0.387,        0,        172.4,        0.279,        1.058],
    [0.7625,        0.387,        0,        172.4,        0.279,        1.058],
    [0.7875,        0.387,        0,        172.4,        0.279,        1.058],
    [0.8125,        0.387,        0,        172.4,        0.279,        1.058],
    ],
    [
    [0.0125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.0375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.0625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.0875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.1125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.1375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.1625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.1875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.2125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.2375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.2625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.2875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.3125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.3375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.3625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.3875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.4125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.4375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.4625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.4875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.5125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.5375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.5625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.5875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.6125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.6375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.6625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.6875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.7125,        0.407,        0,        175.6,        0.252,        1.048],
    [0.7375,        0.407,        0,        175.6,        0.252,        1.048],
    [0.7625,        0.407,        0,        175.6,        0.252,        1.048],
    [0.7875,        0.407,        0,        175.6,        0.252,        1.048],
    [0.8125,        0.407,        0,        175.6,        0.252,        1.048],
    ],
    [
    [0.0125,        0.749524,        3.4114,        328.472,        0.245397,        1.02737],
    [0.0375,        0.758337,        3.41888,        249.678,        0.252985,        1.02653],
    [0.0625,        0.753102,        1.65064,        252.38,        0.26145,        1.03924],
    [0.0875,        0.767264,        0.971101,        240.576,        0.25807,        1.04391],
    [0.1125,        0.76379,        0.67288,        232.762,        0.260968,        1.04479],
    [0.1375,        0.725672,        0.517184,        269.891,        0.252979,        1.04557],
    [0.1625,        0.746365,        0.460779,        249.356,        0.266324,        1.04607],
    [0.1875,        0.745122,        0.453867,        255.368,        0.259697,        1.04639],
    [0.2125,        0.743787,        0.438642,        245.249,        0.260202,        1.0463],
    [0.2375,        0.758661,        0.417178,        248.516,        0.265974,        1.04657],
    [0.2625,        0.741427,        0.378619,        249.567,        0.255871,        1.04658],
    [0.2875,        0.724657,        0.386875,        272.56,        0.260304,        1.04656],
    [0.3125,        0.753439,        0.361549,        243.663,        0.262266,        1.04585],
    [0.3375,        0.751582,        0.341968,        246.786,        0.266466,        1.04684],
    [0.3625,        0.770893,        0.331536,        237.846,        0.262862,        1.04764],
    [0.3875,        0.740973,        0.319102,        260.035,        0.281738,        1.04832],
    [0.4125,        0.709725,        0.290111,        277.744,        0.266134,        1.04774],
    [0.4375,        0.756346,        0.284443,        227.586,        0.275016,        1.04889],
    [0.4625,        0.723314,        0.259922,        265.407,        0.277881,        1.04827],
    [0.4875,        0.731221,        0.243401,        264.371,        0.280891,        1.04862],
    [0.5125,        0.725731,        0.211523,        273.343,        0.295891,        1.04843],
    [0.5375,        0.737103,        0.204169,        273.107,        0.294704,        1.04835],
    [0.5625,        0.74051,        0.178786,        276.257,        0.306084,        1.04963],
    [0.5875,        0.760406,        0.16286,        243.769,        0.303294,        1.04975],
    [0.6125,        0.753571,        0.152971,        249.707,        0.316558,        1.04984],
    [0.6375,        0.70373,        0.132561,        307.459,        0.307159,        1.05165],
    [0.6625,        0.71497,        0.128426,        295.238,        0.323914,        1.05055],
    [0.6875,        0.736348,        0.11495,        292.756,        0.3236,        1.05105],
    [0.7125,        0.717487,        0.100941,        315.459,        0.326321,        1.05174],
    [0.7375,        0.705623,        0.095146,        334.667,        0.32288,        1.05136],
    [0.7625,        0.717022,        0.0924775,        343.388,        0.33635,        1.05236],
    [0.7875,        0.728343,        0.0727395,        319.406,        0.348191,        1.06698],
    [0.8125,        0.760788,        0.16763,        320.832,        0.418838,        1.10261],
    ],
    [
    [0.0125,        0.789041,        4.54131,        333.526,        0.251249,        1.0204],
    [0.0375,        0.774094,        4.21021,        235.804,        0.236632,        1.0241],
    [0.0625,        0.806629,        2.06112,        203.675,        0.236286,        1.03621],
    [0.0875,        0.788436,        1.32736,        219.976,        0.227989,        1.03985],
    [0.1125,        0.78912,        1.01263,        218.396,        0.230885,        1.04087],
    [0.1375,        0.796149,        0.872549,        211.229,        0.237566,        1.04212],
    [0.1625,        0.795688,        0.771431,        201.293,        0.234545,        1.04234],
    [0.1875,        0.765737,        0.752256,        232.183,        0.232333,        1.04266],
    [0.2125,        0.792297,        0.745212,        191.333,        0.229854,        1.04279],
    [0.2375,        0.768787,        0.730987,        217.569,        0.230258,        1.04209],
    [0.2625,        0.780328,        0.726292,        223.237,        0.232874,        1.04262],
    [0.2875,        0.790629,        0.711228,        217.672,        0.241867,        1.04312],
    [0.3125,        0.796076,        0.694144,        198.997,        0.235697,        1.04244],
    [0.3375,        0.801742,        0.652294,        207.709,        0.24776,        1.04291],
    [0.3625,        0.795765,        0.608423,        214.347,        0.244746,        1.04257],
    [0.3875,        0.755667,        0.598937,        248.31,        0.237609,        1.04305],
    [0.4125,        0.735301,        0.536216,        250.159,        0.243219,        1.04291],
    [0.4375,        0.740949,        0.502249,        234.454,        0.242416,        1.04353],
    [0.4625,        0.719183,        0.468967,        259.801,        0.243012,        1.04313],
    [0.4875,        0.732922,        0.414743,        244.314,        0.254767,        1.04314],
    [0.5125,        0.730412,        0.346186,        254.216,        0.256605,        1.04335],
    [0.5375,        0.708133,        0.319278,        305.227,        0.259,        1.04367],
    [0.5625,        0.695266,        0.275955,        303.652,        0.263892,        1.04408],
    [0.5875,        0.734497,        0.253514,        256.448,        0.267965,        1.04371],
    [0.6125,        0.731709,        0.243041,        245.576,        0.269077,        1.04334],
    [0.6375,        0.720436,        0.22513,        285.787,        0.267611,        1.0439],
    [0.6625,        0.713926,        0.190561,        268.057,        0.275604,        1.04376],
    [0.6875,        0.690654,        0.17516,        325.133,        0.287051,        1.04398],
    [0.7125,        0.70025,        0.156716,        306.618,        0.27994,        1.04406],
    [0.7375,        0.689293,        0.130806,        337.289,        0.281216,        1.04395],
    [0.7625,        0.745036,        0.124886,        270.553,        0.285535,        1.04509],
    [0.7875,        0.69581,        0.123195,        340.713,        0.282666,        1.05622],
    [0.8125,        0.766359,        0.250802,        266.423,        0.407071,        1.08136],
    ],
    [
    [0.0125,        0.77872,        8.00064,        363.406,        0.214077,        1.01442],
    [0.0375,        0.756332,        3.33601,        250.49,        0.198396,        1.02028],
    [0.0625,        0.767787,        1.95957,        232.376,        0.19797,        1.03177],
    [0.0875,        0.763524,        1.44037,        217.424,        0.197405,        1.03535],
    [0.1125,        0.782182,        1.17569,        188.681,        0.197004,        1.03676],
    [0.1375,        0.746773,        1.07943,        236.722,        0.190595,        1.03718],
    [0.1625,        0.765432,        0.984718,        211.833,        0.195551,        1.0374],
    [0.1875,        0.732636,        0.999412,        249.277,        0.194953,        1.03765],
    [0.2125,        0.753964,        1.00076,        201.892,        0.192873,        1.03743],
    [0.2375,        0.752383,        0.961328,        214.814,        0.191073,        1.03746],
    [0.2625,        0.741989,        0.991941,        231.127,        0.193524,        1.03743],
    [0.2875,        0.746694,        0.976551,        222.09,        0.193213,        1.03765],
    [0.3125,        0.738584,        0.91646,        232.487,        0.198795,        1.03721],
    [0.3375,        0.726842,        0.910181,        255.894,        0.203519,        1.03759],
    [0.3625,        0.759694,        0.848248,        206.943,        0.202991,        1.03786],
    [0.3875,        0.725318,        0.839681,        253.422,        0.20095,        1.03769],
    [0.4125,        0.711842,        0.749544,        240.853,        0.201568,        1.03753],
    [0.4375,        0.716773,        0.693413,        229.429,        0.207945,        1.03788],
    [0.4625,        0.709747,        0.628388,        241.972,        0.204827,        1.03782],
    [0.4875,        0.709444,        0.550469,        244.075,        0.212452,        1.03786],
    [0.5125,        0.7036,        0.446243,        273.155,        0.218522,        1.03764],
    [0.5375,        0.695819,        0.407354,        270.767,        0.214545,        1.03754],
    [0.5625,        0.714163,        0.343423,        229.255,        0.222618,        1.03741],
    [0.5875,        0.719065,        0.322455,        233.053,        0.222758,        1.03741],
    [0.6125,        0.695372,        0.290167,        265.557,        0.228441,        1.03723],
    [0.6375,        0.692985,        0.281202,        263.562,        0.230916,        1.03758],
    [0.6625,        0.701399,        0.223977,        251.292,        0.22046,        1.03749],
    [0.6875,        0.699623,        0.207688,        268.645,        0.232536,        1.03754],
    [0.7125,        0.677909,        0.17089,        323.312,        0.237568,        1.03731],
    [0.7375,        0.667757,        0.153148,        358.76,        0.234893,        1.03749],
    [0.7625,        0.699151,        0.121198,        294.9,        0.238249,        1.03741],
    [0.7875,        0.700245,        0.127386,        301.108,        0.229368,        1.0479],
    [0.8125,        0.710124,        0.310411,        279.08,        0.381441,        1.06573],
    ]
    ]


LArTBClusterMaker.weights.EtaMax = 1.1875   #not geometrically possible to move the calo to eta>1.2
LArTBClusterMaker.weights.region = CALOCORR_CLUSTER 
LArTBClusterMaker.weights.degree = 3
LArTBClusterMaker.weights.energies = str(energy_samples_vle)
LArTBClusterMaker.weights.correction = str(CaloTB_lwc_33)
LArTBClusterMaker.weights.EtaBarrel = 1.375
LArTBClusterMaker.weights.EtaEndCap = 1.525


#
#Eta versus Energy modulation
#
CaloSw_rfac = [
[0.0125,   9.158837e-01],
[0.0375,   9.549339e-01],
[0.0625,   9.574016e-01],
[0.0875,   9.579815e-01],
[0.1125,   9.579382e-01],
[0.1375,   9.580596e-01],
[0.1625,   9.577885e-01],
[0.1875,   9.584260e-01],
[0.2125,   9.573891e-01],
[0.2375,   9.583148e-01],
[0.2625,   9.583855e-01],
[0.2875,   9.586575e-01],
[0.3125,   9.586427e-01],
[0.3375,   9.585706e-01],
[0.3625,   9.593939e-01],
[0.3875,   9.587972e-01],
[0.4125,   9.592283e-01],
[0.4375,   9.592296e-01],
[0.4625,   9.598244e-01],
[0.4875,   9.592557e-01],
[0.5125,   9.591028e-01],
[0.5375,   9.581793e-01],
[0.5625,   9.584898e-01],
[0.5875,   9.587682e-01],
[0.6125,   9.588540e-01],
[0.6375,   9.569409e-01],
[0.6625,   9.532247e-01],
[0.6875,   9.514746e-01],
[0.7125,   9.508389e-01],
[0.7375,   9.488401e-01],
[0.7625,   8.092602e-01],
[0.7875,   7.399155e-01],
[0.8125,   7.738033e-01],
[0.8375,   9.371027e-01],
[0.8625,   9.370135e-01],
[0.8875,   9.347815e-01],
[0.9125,   9.346408e-01],
[0.9375,   9.346482e-01],
[0.9625,   9.324597e-01],
[0.9875,   9.313113e-01],
[1.0125,   9.298394e-01],
[1.0375,   9.270200e-01],
[1.0625,   9.269487e-01],
[1.0875,   9.244406e-01],
[1.1125,   9.221041e-01],
[1.1375,   9.223799e-01],
[1.1625,   9.202957e-01],
[1.1875,   9.186866e-01],
[1.2125,   9.129674e-01],
[1.2375,   9.126045e-01],
[1.2625,   9.096150e-01],
[1.2875,   9.070148e-01],
[1.3125,   9.008394e-01],
[1.3375,   8.925832e-01],
[1.3625,   8.763337e-01],
[1.3875,   8.656485e-01],
[1.4125,   8.609927e-01],
[1.4375,   7.805832e-01],
[1.4625,   6.015924e-01],
[1.4875,   5.502519e-01],
[1.5125,   6.945754e-01],
[1.5375,   8.477056e-01],
[1.5625,   9.254098e-01],
[1.5875,   9.287047e-01],
[1.6125,   9.302695e-01],
[1.6375,   9.154825e-01],
[1.6625,   9.115917e-01],
[1.6875,   9.014728e-01],
[1.7125,   9.374421e-01],
[1.7375,   9.427920e-01],
[1.7625,   9.382549e-01],
[1.7875,   9.351722e-01],
[1.8125,   9.160857e-01],
[1.8375,   9.065793e-01],
[1.8625,   9.099748e-01],
[1.8875,   9.145431e-01],
[1.9125,   9.176964e-01],
[1.9375,   9.209157e-01],
[1.9625,   9.224258e-01],
[1.9875,   9.223443e-01],
[2.0125,   9.215440e-01],
[2.0375,   9.190382e-01],
[2.0625,   9.199215e-01],
[2.0875,   9.187429e-01],
[2.1125,   9.182841e-01],
[2.1375,   9.171402e-01],
[2.1625,   9.178473e-01],
[2.1875,   9.173785e-01],
[2.2125,   9.170678e-01],
[2.2375,   9.172518e-01],
[2.2625,   9.178104e-01],
[2.2875,   9.188930e-01],
[2.3125,   9.184640e-01],
[2.3375,   9.196976e-01],
[2.3625,   9.200801e-01],
[2.3875,   9.234573e-01],
[2.4125,   9.244256e-01],
[2.4375,   9.254043e-01],
[2.4625,   9.163888e-01],
[2.4875,   8.225253e-01],
    ]

LArTBClusterMaker.etamod.region = CALOCORR_COMBINED2
LArTBClusterMaker.etamod.energies = str([250*GeV])
LArTBClusterMaker.etamod.energy_degree = 2
LArTBClusterMaker.etamod.rfac = str(CaloSw_rfac)
LArTBClusterMaker.etamod.rfac_degree = 2
LArTBClusterMaker.etamod.correction = str([
    [0.993, 1.28, -61.1]
    ])
    


LArTBClusterMaker.phipar.region = CALOCORR_COMBINED2
LArTBClusterMaker.phipar.energies= str([50*GeV])
LArTBClusterMaker.phipar.degree=2
LArTBClusterMaker.phipar.correction =str([
    [0.9899, 1.67,  -71.16]
    ])


CaloSw_rfac = [
[0.0125,   9.158837e-01],
[0.0375,   9.549339e-01],
[0.0625,   9.574016e-01],
[0.0875,   9.579815e-01],
[0.1125,   9.579382e-01],
[0.1375,   9.580596e-01],
[0.1625,   9.577885e-01],
[0.1875,   9.584260e-01],
[0.2125,   9.573891e-01],
[0.2375,   9.583148e-01],
[0.2625,   9.583855e-01],
[0.2875,   9.586575e-01],
[0.3125,   9.586427e-01],
[0.3375,   9.585706e-01],
[0.3625,   9.593939e-01],
[0.3875,   9.587972e-01],
[0.4125,   9.592283e-01],
[0.4375,   9.592296e-01],
[0.4625,   9.598244e-01],
[0.4875,   9.592557e-01],
[0.5125,   9.591028e-01],
[0.5375,   9.581793e-01],
[0.5625,   9.584898e-01],
[0.5875,   9.587682e-01],
[0.6125,   9.588540e-01],
[0.6375,   9.569409e-01],
[0.6625,   9.532247e-01],
[0.6875,   9.514746e-01],
[0.7125,   9.508389e-01],
[0.7375,   9.488401e-01],
[0.7625,   8.092602e-01],
[0.7875,   7.399155e-01],
[0.8125,   7.738033e-01],
[0.8375,   9.371027e-01],
[0.8625,   9.370135e-01],
[0.8875,   9.347815e-01],
[0.9125,   9.346408e-01],
[0.9375,   9.346482e-01],
[0.9625,   9.324597e-01],
[0.9875,   9.313113e-01],
[1.0125,   9.298394e-01],
[1.0375,   9.270200e-01],
[1.0625,   9.269487e-01],
[1.0875,   9.244406e-01],
[1.1125,   9.221041e-01],
[1.1375,   9.223799e-01],
[1.1625,   9.202957e-01],
[1.1875,   9.186866e-01],
[1.2125,   9.129674e-01],
[1.2375,   9.126045e-01],
[1.2625,   9.096150e-01],
[1.2875,   9.070148e-01],
[1.3125,   9.008394e-01],
[1.3375,   8.925832e-01],
[1.3625,   8.763337e-01],
[1.3875,   8.656485e-01],
[1.4125,   8.609927e-01],
[1.4375,   7.805832e-01],
[1.4625,   6.015924e-01],
[1.4875,   5.502519e-01],
[1.5125,   6.945754e-01],
[1.5375,   8.477056e-01],
[1.5625,   9.254098e-01],
[1.5875,   9.287047e-01],
[1.6125,   9.302695e-01],
[1.6375,   9.154825e-01],
[1.6625,   9.115917e-01],
[1.6875,   9.014728e-01],
[1.7125,   9.374421e-01],
[1.7375,   9.427920e-01],
[1.7625,   9.382549e-01],
[1.7875,   9.351722e-01],
[1.8125,   9.160857e-01],
[1.8375,   9.065793e-01],
[1.8625,   9.099748e-01],
[1.8875,   9.145431e-01],
[1.9125,   9.176964e-01],
[1.9375,   9.209157e-01],
[1.9625,   9.224258e-01],
[1.9875,   9.223443e-01],
[2.0125,   9.215440e-01],
[2.0375,   9.190382e-01],
[2.0625,   9.199215e-01],
[2.0875,   9.187429e-01],
[2.1125,   9.182841e-01],
[2.1375,   9.171402e-01],
[2.1625,   9.178473e-01],
[2.1875,   9.173785e-01],
[2.2125,   9.170678e-01],
[2.2375,   9.172518e-01],
[2.2625,   9.178104e-01],
[2.2875,   9.188930e-01],
[2.3125,   9.184640e-01],
[2.3375,   9.196976e-01],
[2.3625,   9.200801e-01],
[2.3875,   9.234573e-01],
[2.4125,   9.244256e-01],
[2.4375,   9.254043e-01],
[2.4625,   9.163888e-01],
[2.4875,   8.225253e-01],
    ]

LArTBClusterMaker.phimod.region = CALOCORR_COMBINED2
LArTBClusterMaker.phimod.correction_coef = 0.001
LArTBClusterMaker.phimod.interp_barriers = str([1.5])
LArTBClusterMaker.phimod.degree = 3
LArTBClusterMaker.phimod.energies = str([50*GeV])
LArTBClusterMaker.phimod.energy_degree = 2
LArTBClusterMaker.phimod.rfac = str(CaloSw_rfac)
LArTBClusterMaker.phimod.rfac_degree = 2
LArTBClusterMaker.phimod.use_raw_eta = False
LArTBClusterMaker.phimod.correction =str([
    [
    [0.025,  1.25161e+00,  -5.08184e+00,  -2.04206e-01,  -5.21328e-01],
    [0.1,    9.99981e-01,  -4.43986e+00,  -6.54703e-01,  -7.39519e-01],
    [0.35,   2.56623e+00,  -6.15057e+00,  3.50645e-01,   1.69602e+00],
    [0.45,   1.79800e+00,  -5.27121e-01,  -3.06311e-01,  2.24066e+00],
    [0.65,   8.28142e+00,  -2.67573e+00,  1.99701e+00,   -1.86370e+00],
    [1.00,   4.06097e+00,  -5.82282e+00,  1.47370e-01,   -4.05084e+00],
    [1.10,   4.06295e+00,  -5.55664e+00,  -2.50247e-01,  1.44538e+00]
    ]
    ])
