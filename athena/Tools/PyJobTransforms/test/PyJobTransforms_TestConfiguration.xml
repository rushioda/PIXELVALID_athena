<?xml version="1.0"?>
<!DOCTYPE unifiedTestConfiguration SYSTEM "http://www.hep.ucl.ac.uk/atlas/AtlasTesting/DTD/unifiedTestConfiguration.dtd">

<unifiedTestConfiguration>
   <atn>
    
    <TEST name="transform" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_transform.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>
    
    <TEST name="trfArgClasses" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfArgClasses.py
      </options_atn>
      <timelimit>10</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfArgs" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfArgs.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>
    
    <TEST name="trfDecorators" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfDecorators.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfExceptions" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfExceptions.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfExe" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfExe.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>
    <TEST name="trfExitCodes" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfExitCodes.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>
    
    <TEST name="trfFileUtils" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfFileUtils.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfGraph" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfGraph.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfJobOptions" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfJobOptions.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfLogger" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfLogger.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfReports" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfReports.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfSignal" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfSignal.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfUtils" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfUtils.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>    

    <TEST name="trfUtils" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfUtilsParallelJobProcessor.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Will Breaden Madden</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfValidateRootFile" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfValidateRootFile.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

    <TEST name="trfValidation" type="script" suite="PyJobTransforms-CoreTests">
      <options_atn>
      ${ATN_PACKAGE}/test/test_trfValidation.py
      </options_atn>
      <timelimit>2</timelimit>
      <author>Graeme Stewart</author>
      <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
      <expectations>
        <errorMessage>FAILED </errorMessage>
        <returnValue>0</returnValue>
      </expectations>
    </TEST>

  </atn>
  
  <rtt xmlns="http://www.hep.ucl.ac.uk/atlas/AtlasTesting/rtt">
    
    <rttContactPerson>Graeme Stewart</rttContactPerson>
    <mailto>atlas-comp-transforms-dev@cern.ch</mailto>
    
    <jobList>
      
      <classification>
        <displayClass>OfflineValidation</displayClass>
        <displayProcess>Transforms</displayProcess>
        <displayComponent>Core</displayComponent>
      </classification>
      
        <jobTransform userJobId="ArgClassesTest">
          <doc>Unittest suite for trfArgClasses</doc>
          <jobTransformJobName>trfArgClasses</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfArgClasses.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="ArgClassesATLASTest">
          <doc>Unittest suite for trfArgClasses, ATLAS specific data formats</doc>
          <jobTransformJobName>trfArgClassesATLAS</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfArgClassesATLAS.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="AMITagTest">
          <doc>Unittest suite for AMI tag resolution</doc>
          <jobTransformJobName>trfArgClasses</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfAMI.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="DBReleaseTest">
          <doc>Unittest suite for trfArgClasses</doc>
          <jobTransformJobName>DBRelease</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfUtilsDBRelease.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

	<!-- Disable this test until it's fixed properly
        <jobTransform userJobId="ParallelJobProcessorDataTest">
          <doc>Unittest suite for ParallelJobProcessorData</doc>
          <jobTransformJobName>trfUtilsParallelJobProcessorData</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfUtilsParallelJobProcessorData
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>
        -->

        <jobTransform userJobId="EchoTest">
          <doc>Test echo transform runs correctly</doc>
          <jobTransformJobName>Echo_tf</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_Echo_tf.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>
      
        <jobTransform userJobId="SleepTest">
          <doc>Test sleep transform runs correctly</doc>
          <jobTransformJobName>Sleep_tf</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_Sleep_tf.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="LogScanTest">
          <doc>Test logfile scanning options</doc>
          <jobTransformJobName>trfArgClasses</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_LogFileScanner.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="RAWMergeTest">
          <doc>Test RAW merging transform runs correctly</doc>
          <jobTransformJobName>RAWMerge_tf</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_RAWMerge_tf.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="TAGMergeTest">
          <doc>Test TAG merging transform runs correctly</doc>
          <jobTransformJobName>TAGMerge_tf</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_TAGMerge_tf.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="HISTMergeTest">
          <doc>Test DQ HIST merging runs correctly</doc>
          <jobTransformJobName>HISTMerge_tf</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_HISTMerge_tf.py
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>medium</queue>
        </jobTransform>

        <jobTransform userJobId="SignatureTest">
          <doc>Test transform signatures generate ok</doc>
          <jobTransformJobName>makeTrfJSONSignatures</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfSignatures.py 
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

        <jobTransform userJobId="SubstepIntegratonTest">
          <doc>Test compound transforms can be constructed ok</doc>
          <jobTransformJobName>SubstepIntegration</jobTransformJobName>
          <jobTransformCmd>
            TransformTestRunner.py test_trfSubstepIntegration.py 
          </jobTransformCmd>
          <group>PyJobTransforms:TransformCoreTests</group>
          <queue>short</queue>
        </jobTransform>

    </jobList>
    
	<jobGroups>
		<jobGroup name="TransformCoreTests" parent="RTT:Athena">
			<!-- Keep substep logs and the JSON job report(s) -->
			<keepFilePattern>jobReport*.json</keepFilePattern>
			<keepFilePattern>log.*</keepFilePattern>
			<!-- Suppress the test which checks for *.pool.root files -->
            <testToRemove>
	   	  	  	<jobGroupName>RTT:Top</jobGroupName>
   			  	<testidentifier>CheckFileRunner0</testidentifier> 
		    </testToRemove>
		    <!-- Supress the test which checks for WARN lines in the logs -->
            <testToRemove>
	   		  	<jobGroupName>RTT:Athena</jobGroupName>
   			  	<testidentifier>Athena_FileGrepper1</testidentifier> 
		    </testToRemove>
          	<!-- Reco often produces suprious "ERROR" messages that the RTT test is too sensitive to -->
          	<testToRemove>
	   		  	<jobGroupName>RTT:Athena</jobGroupName>
   			  	<testidentifier>Athena_FileGrepper</testidentifier> 
		  	</testToRemove>
		</jobGroup>
	</jobGroups>
    
  </rtt>
  
</unifiedTestConfiguration>
